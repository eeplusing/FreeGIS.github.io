<figure class="highlight plain"><figcaption><span>html></span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;title&gt;自定义动画&lt;/title&gt;</div><div class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://openlayers.org/en/v3.16.0/css/ol.css&quot; type=&quot;text/css&quot;&gt;</div><div class="line">    &lt;script src=&quot;http://openlayers.org/en/v3.16.0/build/ol.js&quot;&gt;&lt;/script&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;div id=&quot;map&quot; class=&quot;map&quot;&gt;&lt;/div&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">      var map = new ol.Map(&#123;</div><div class="line">        layers: [</div><div class="line">          new ol.layer.Tile(&#123;</div><div class="line">            source: new ol.source.OSM(&#123;</div><div class="line">              wrapX: false</div><div class="line">            &#125;)</div><div class="line">          &#125;)</div><div class="line">        ],</div><div class="line">        controls: ol.control.defaults(&#123;</div><div class="line">          attributionOptions: /** @type &#123;olx.control.AttributionOptions&#125; */ (&#123;</div><div class="line">            collapsible: false</div><div class="line">          &#125;)</div><div class="line">        &#125;),</div><div class="line">        target: &apos;map&apos;,</div><div class="line">        view: new ol.View(&#123;</div><div class="line">          center: [0, 0],</div><div class="line">          zoom: 1</div><div class="line">        &#125;)</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">      var source = new ol.source.Vector(&#123;</div><div class="line">        wrapX: false</div><div class="line">      &#125;);</div><div class="line">      var vector = new ol.layer.Vector(&#123;</div><div class="line">        source: source</div><div class="line">      &#125;);</div><div class="line">      map.addLayer(vector);</div><div class="line"></div><div class="line">      function addRandomFeature() &#123;</div><div class="line">        var x = Math.random() * 360 - 180;</div><div class="line">        var y = Math.random() * 180 - 90;</div><div class="line">        var geom = new ol.geom.Point(ol.proj.transform([x, y],</div><div class="line">            &apos;EPSG:4326&apos;, &apos;EPSG:3857&apos;));</div><div class="line">        var feature = new ol.Feature(geom);</div><div class="line">        source.addFeature(feature);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      var duration = 3000;</div><div class="line">      function flash(feature) &#123;</div><div class="line">        var start = new Date().getTime();</div><div class="line">        var listenerKey;</div><div class="line"></div><div class="line">        function animate(event) &#123;</div><div class="line">          var vectorContext = event.vectorContext;</div><div class="line">          var frameState = event.frameState;</div><div class="line">          var flashGeom = feature.getGeometry().clone();</div><div class="line">          var elapsed = frameState.time - start;</div><div class="line">          var elapsedRatio = elapsed / duration;</div><div class="line">          // radius will be 5 at start and 30 at end.</div><div class="line">          var radius = ol.easing.easeOut(elapsedRatio) * 10 + 5;</div><div class="line">          var opacity = ol.easing.easeOut(1 - elapsedRatio);</div><div class="line">          var style = new ol.style.Style(&#123;</div><div class="line">            image: new ol.style.Circle(&#123;</div><div class="line">              radius: radius,</div><div class="line">              snapToPixel: false,</div><div class="line">              stroke: new ol.style.Stroke(&#123;</div><div class="line">                color: &apos;rgba(255, 0, 0, &apos; + opacity + &apos;)&apos;,</div><div class="line">                width: 0.25 + opacity</div><div class="line">              &#125;)</div><div class="line">            &#125;)</div><div class="line">          &#125;);</div><div class="line"></div><div class="line">          vectorContext.setStyle(style);</div><div class="line">          vectorContext.drawGeometry(flashGeom);</div><div class="line">          if (elapsed &gt; duration) &#123;</div><div class="line">			start = new Date().getTime();</div><div class="line">			animate(event);</div><div class="line">          &#125;</div><div class="line">          map.render();</div><div class="line">        &#125;</div><div class="line">        listenerKey = map.on(&apos;postcompose&apos;, animate);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      source.on(&apos;addfeature&apos;, function(e) &#123;</div><div class="line">        flash(e.feature);</div><div class="line">      &#125;);</div><div class="line">	  addRandomFeature();</div><div class="line">      //window.setInterval(addRandomFeature, 1000);</div><div class="line">    &lt;/script&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>