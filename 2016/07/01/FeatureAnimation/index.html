<p>&lt;!DOCTYPE html&gt;</p>
<html><br>  <head><br>    <title>自定义动画</title><br>    <link rel="stylesheet" href="http://openlayers.org/en/v3.16.0/css/ol.css" type="text/css"><br>    <script src="http://openlayers.org/en/v3.16.0/build/ol.js"></script><br>  </head><br>  <body><br>    <div id="map" class="map"></div><br>    <script><br>      var map = new ol.Map({<br>        layers: [<br>          new ol.layer.Tile({<br>            source: new ol.source.OSM({<br>              wrapX: false<br>            })<br>          })<br>        ],<br>        controls: ol.control.defaults({<br>          attributionOptions: /<em>* @type {olx.control.AttributionOptions} </em>/ ({<br>            collapsible: false<br>          })<br>        }),<br>        target: ‘map’,<br>        view: new ol.View({<br>          center: [0, 0],<br>          zoom: 1<br>        })<br>      });<br><br>      var source = new ol.source.Vector({<br>        wrapX: false<br>      });<br>      var vector = new ol.layer.Vector({<br>        source: source<br>      });<br>      map.addLayer(vector);<br><br>      function addRandomFeature() {<br>        var x = Math.random() <em> 360 - 180;<br>        var y = Math.random() </em> 180 - 90;<br>        var geom = new ol.geom.Point(ol.proj.transform([x, y],<br>            ‘EPSG:4326’, ‘EPSG:3857’));<br>        var feature = new ol.Feature(geom);<br>        source.addFeature(feature);<br>      }<br><br>      var duration = 3000;<br>      function flash(feature) {<br>        var start = new Date().getTime();<br>        var listenerKey;<br><br>        function animate(event) {<br>          var vectorContext = event.vectorContext;<br>          var frameState = event.frameState;<br>          var flashGeom = feature.getGeometry().clone();<br>          var elapsed = frameState.time - start;<br>          var elapsedRatio = elapsed / duration;<br>          // radius will be 5 at start and 30 at end.<br>          var radius = ol.easing.easeOut(elapsedRatio) * 10 + 5;<br>          var opacity = ol.easing.easeOut(1 - elapsedRatio);<br>          var style = new ol.style.Style({<br>            image: new ol.style.Circle({<br>              radius: radius,<br>              snapToPixel: false,<br>              stroke: new ol.style.Stroke({<br>                color: ‘rgba(255, 0, 0, ‘ + opacity + ‘)’,<br>                width: 0.25 + opacity<br>              })<br>            })<br>          });<br><br>          vectorContext.setStyle(style);<br>          vectorContext.drawGeometry(flashGeom);<br>          if (elapsed &gt; duration) {<br>            start = new Date().getTime();<br>            animate(event);<br>          }<br>          map.render();<br>        }<br>        listenerKey = map.on(‘postcompose’, animate);<br>      }<br><br>      source.on(‘addfeature’, function(e) {<br>        flash(e.feature);<br>      });<br>      addRandomFeature();<br>      //window.setInterval(addRandomFeature, 1000);<br>    </script><br>  </body><br></html>